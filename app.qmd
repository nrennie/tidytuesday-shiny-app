---
title: "#TidyTuesday"
author: "Nicola Rennie"
format:
  html: 
    theme: [solar, style.scss]
server: shiny
---

#TidyTuesday is a weekly data challenge aimed at the R community. Every week a new dataset is posted alongside a chart or article related to that dataset, and ask participants explore the data. You can access the data and find out more on [GitHub](https://github.com/rfordatascience/tidytuesday/blob/master/README.md).

```{r}
#| context: setup
all_weeks <- readxl::read_xlsx("data/all_weeks.xlsx")
all_titles <- all_weeks$title
```

```{r}
selectInput("plot_title",
            "Select a plot:",
            all_titles, width = "100%")
textOutput("pkgs_used")
htmlOutput("code_link")
br()
htmlOutput("plot_img")
```

```{r}
#| context: server
week_data <- reactive({
  all_weeks |> 
    dplyr::filter(title == input$plot_title)
})

img_path <- reactive({
  fpath <- glue::glue(
    "https://raw.githubusercontent.com/nrennie/tidytuesday/main/{week_data()$img_fpath}"
  )
  fpath
})

code_path <- reactive({
  fpath <- glue::glue(
    "https://github.com/nrennie/tidytuesday/tree/main/{week_data()$code_fpath}"
  )
  fpath
})

output$plot_img <- renderText({
  c('<img src="', img_path(), '" width="100%">')
  })

output$pkgs_used <- renderText({
  glue::glue("This plot uses the following packages: {week_data()$pkgs}")
})

output$code_link <- renderText({
  glue::glue('Code is available at: <a href="{code_path()}"  target="_blank">{code_path()}</a>.')
})
```


